<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="custom-style.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
	<div style="overflow: hidden;">
		<div style="height: 57px;min-width: 1039px;background-size: auto 100%;background:url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAABwgAAAABCAYAAADKO/rAAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAABRSURBVFhH7dUxCoBADEXB5LK5/w1iIaLIrsgWNs50Sf/4WVUd8HOZGd1nCqMbGNMPrNMPrJv1cvz0A3OjfuwPvDPrxf7A7t7IlX7gmX74VsQGguw4S6+UnSYAAAAASUVORK5CYII=');">
			<img src="titleleft.png" style="float: left;"/>
			<img src="titleright.png" alt="" style="float: right;" />
		</div>
	</div>
<!-- Generated by Doxygen 1.8.15 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Disclaimer</span></a></li>
      <li><a href="_xE9_xA6_x96_xE9_xA1_xB5.html"><span>Home&#160;Page</span></a></li>
      <li><a href="_s_d_k_xE7_x89_x88_xE6_x9C_xAC_xE6_x9B_xB4_xE6_x96_xB0_xE8_xAE_xB0_xE5_xBD_x95.html"><span>Update&#160;History</span></a></li>
      <li><a href="usergroup0.html"><span>Programming&#160;Guide</span></a></li>
      <li><a href="modules.html"><span>API&#160;Reference&#160;and&#160;Data&#160;Structure</span></a></li>
      <li><a href="usergroup1.html"><span>Sample&#160;Program</span></a></li>
      <li><a href="_error_code.html"><span>Error&#160;Code</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="PageDoc"><div class="contents">
<div class="textblock"><div class="header" style="margin-left:-12px;margin-top:-10px;margin-right:-8px;"> <div class="headertitle"> <div class="title">Get Images in Callback Function (GrabImage_Callback.cpp)</div> </div> </div> <div id="hikvision"> <br />
</div><div id="hikvision">This sample program shows how to get camera images in callback function. The process includes: open the frame grabber, open the camera, open the stream channel, set the number of internal buffers, register callback function, start image acquisition, stop image acquisition, close the stream channel, close the camera, and close the frame grabber. <div class="fragment"><div class="line"><span class="preprocessor">#include &lt;stdio.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;Windows.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;process.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;conio.h&gt;</span></div><div class="line"><span class="preprocessor">#include &quot;MVFGControl.h&quot;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#define BUFFER_NUMBER       3       // Number of requested buffers</span></div><div class="line"></div><div class="line"><span class="comment">// Wait for key press</span></div><div class="line"><span class="keywordtype">void</span> WaitForKeyPress(<span class="keywordtype">void</span>)</div><div class="line">{</div><div class="line">    <span class="keywordflow">while</span>(!_kbhit())</div><div class="line">    {</div><div class="line">        Sleep(10);</div><div class="line">    }</div><div class="line">    _getch();</div><div class="line">}</div><div class="line"></div><div class="line"><span class="comment">// Clear stdin</span></div><div class="line"><span class="keywordtype">void</span> ClearStdin(<span class="keywordtype">void</span>)</div><div class="line">{</div><div class="line">    <span class="keywordtype">char</span> c = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"></div><div class="line">    <span class="keywordflow">while</span> (1)</div><div class="line">    {</div><div class="line">        c = getchar();</div><div class="line">        <span class="keywordflow">if</span> (<span class="charliteral">&#39;\n&#39;</span> == c || EOF == c)</div><div class="line">        {</div><div class="line">            <span class="keywordflow">break</span>;</div><div class="line">        }</div><div class="line">    }</div><div class="line">}</div><div class="line"></div><div class="line"><span class="comment">// Frame information callback</span></div><div class="line"><span class="keywordtype">void</span> __stdcall FrameCb(<a class="code" href="struct_m_v___f_g___b_u_f_f_e_r___i_n_f_o.html">MV_FG_BUFFER_INFO</a>* pstBufferInfo, <span class="keywordtype">void</span>* pUser)</div><div class="line">{</div><div class="line">    <span class="keywordflow">if</span> (pstBufferInfo)</div><div class="line">    {</div><div class="line">        printf(<span class="stringliteral">&quot;FrameNumber:%2I64d%, Width:%d, Height:%d\n&quot;</span>, pstBufferInfo-&gt;<a class="code" href="struct_m_v___f_g___b_u_f_f_e_r___i_n_f_o.html#a93ebaf10b2b24fa20dc7860964563a22">nFrameID</a>, pstBufferInfo-&gt;<a class="code" href="struct_m_v___f_g___b_u_f_f_e_r___i_n_f_o.html#abbc1b35442c6143931edc0189a3432fb">nWidth</a>, pstBufferInfo-&gt;<a class="code" href="struct_m_v___f_g___b_u_f_f_e_r___i_n_f_o.html#a2e4c6b811457a16b7033af6741cfb1db">nHeight</a>);</div><div class="line">    }</div><div class="line">}</div><div class="line"></div><div class="line"><span class="comment">// Print frame grabber information</span></div><div class="line"><span class="keywordtype">bool</span> PrintInterfaceInfo(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nInterfaceNum)</div><div class="line">{</div><div class="line">    <span class="keywordtype">int</span> nRet = 0;</div><div class="line"></div><div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; nInterfaceNum; i++)</div><div class="line">    {</div><div class="line">        <a class="code" href="struct_m_v___f_g___i_n_t_e_r_f_a_c_e___i_n_f_o.html">MV_FG_INTERFACE_INFO</a> stInterfaceInfo = { 0 };</div><div class="line"></div><div class="line">        nRet = <a class="code" href="group___xE9_x87_x87_xE9_x9B_x86_xE5_x8D_xA1_xE6_x8E_xA5_xE5_x8F_xA3.html#ga568d936f246163171ba7c7512462ae82">MV_FG_GetInterfaceInfo</a>(i, &amp;stInterfaceInfo);</div><div class="line">        <span class="keywordflow">if</span> (MV_FG_SUCCESS != nRet)</div><div class="line">        {</div><div class="line">            printf(<span class="stringliteral">&quot;Get info of No.%d interface failed! %#x\n&quot;</span>, i, nRet);</div><div class="line">            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line">        }</div><div class="line"></div><div class="line">        <span class="keywordflow">switch</span> (stInterfaceInfo.<a class="code" href="struct_m_v___f_g___i_n_t_e_r_f_a_c_e___i_n_f_o.html#a3b26b1c9681dba57af81bdb7ed795575">nTLayerType</a>)</div><div class="line">        {</div><div class="line">        <span class="keywordflow">case</span> <a class="code" href="group___xE5_xAE_x8F_xE5_xAE_x9A_xE4_xB9_x89.html#gab9b05f0522e4b358ed02c8bff9b5a46c">MV_FG_CXP_INTERFACE</a>:</div><div class="line">            {</div><div class="line">                printf(<span class="stringliteral">&quot;[CXP]No.%d Interface: \n\tDisplayName: %s\n\tInterfaceID: %s\n\tSerialNumber:%s\n&quot;</span>, i, </div><div class="line">                    stInterfaceInfo.<a class="code" href="struct_m_v___f_g___i_n_t_e_r_f_a_c_e___i_n_f_o.html#afb77e70ec406cf3b67e6f1d5c0fd33de">IfaceInfo</a>.<a class="code" href="struct_m_v___f_g___i_n_t_e_r_f_a_c_e___i_n_f_o.html#a3b193dba85ce79be2dbacdf03e97cdaa">stCXPIfaceInfo</a>.<a class="code" href="struct_m_v___c_x_p___i_n_t_e_r_f_a_c_e___i_n_f_o.html#aa7711c64eb456bf7b54b3912ae2c2217">chDisplayName</a>, </div><div class="line">                    stInterfaceInfo.<a class="code" href="struct_m_v___f_g___i_n_t_e_r_f_a_c_e___i_n_f_o.html#afb77e70ec406cf3b67e6f1d5c0fd33de">IfaceInfo</a>.<a class="code" href="struct_m_v___f_g___i_n_t_e_r_f_a_c_e___i_n_f_o.html#a3b193dba85ce79be2dbacdf03e97cdaa">stCXPIfaceInfo</a>.<a class="code" href="struct_m_v___c_x_p___i_n_t_e_r_f_a_c_e___i_n_f_o.html#a5970c47b258315360bf252b26c7d9112">chInterfaceID</a>, </div><div class="line">                    stInterfaceInfo.<a class="code" href="struct_m_v___f_g___i_n_t_e_r_f_a_c_e___i_n_f_o.html#afb77e70ec406cf3b67e6f1d5c0fd33de">IfaceInfo</a>.<a class="code" href="struct_m_v___f_g___i_n_t_e_r_f_a_c_e___i_n_f_o.html#a3b193dba85ce79be2dbacdf03e97cdaa">stCXPIfaceInfo</a>.<a class="code" href="struct_m_v___c_x_p___i_n_t_e_r_f_a_c_e___i_n_f_o.html#ad313642c0cca5a1a5c80149796732d18">chSerialNumber</a>);</div><div class="line">                <span class="keywordflow">break</span>;</div><div class="line">            }</div><div class="line">        <span class="keywordflow">case</span> <a class="code" href="group___xE5_xAE_x8F_xE5_xAE_x9A_xE4_xB9_x89.html#gadad33b1e17a74130be022c10652b7912">MV_FG_GEV_INTERFACE</a>:</div><div class="line">            {</div><div class="line">                printf(<span class="stringliteral">&quot;[GEV]No.%d Interface: \n\tDisplayName: %s\n\tInterfaceID: %s\n\tSerialNumber:%s\n&quot;</span>, i, </div><div class="line">                    stInterfaceInfo.<a class="code" href="struct_m_v___f_g___i_n_t_e_r_f_a_c_e___i_n_f_o.html#afb77e70ec406cf3b67e6f1d5c0fd33de">IfaceInfo</a>.<a class="code" href="struct_m_v___f_g___i_n_t_e_r_f_a_c_e___i_n_f_o.html#a03ae441d02d4a068afcf11b397ff4014">stGEVIfaceInfo</a>.<a class="code" href="struct_m_v___g_e_v___i_n_t_e_r_f_a_c_e___i_n_f_o.html#aa7711c64eb456bf7b54b3912ae2c2217">chDisplayName</a>, </div><div class="line">                    stInterfaceInfo.<a class="code" href="struct_m_v___f_g___i_n_t_e_r_f_a_c_e___i_n_f_o.html#afb77e70ec406cf3b67e6f1d5c0fd33de">IfaceInfo</a>.<a class="code" href="struct_m_v___f_g___i_n_t_e_r_f_a_c_e___i_n_f_o.html#a03ae441d02d4a068afcf11b397ff4014">stGEVIfaceInfo</a>.<a class="code" href="struct_m_v___g_e_v___i_n_t_e_r_f_a_c_e___i_n_f_o.html#a5970c47b258315360bf252b26c7d9112">chInterfaceID</a>, </div><div class="line">                    stInterfaceInfo.<a class="code" href="struct_m_v___f_g___i_n_t_e_r_f_a_c_e___i_n_f_o.html#afb77e70ec406cf3b67e6f1d5c0fd33de">IfaceInfo</a>.<a class="code" href="struct_m_v___f_g___i_n_t_e_r_f_a_c_e___i_n_f_o.html#a03ae441d02d4a068afcf11b397ff4014">stGEVIfaceInfo</a>.<a class="code" href="struct_m_v___g_e_v___i_n_t_e_r_f_a_c_e___i_n_f_o.html#ad313642c0cca5a1a5c80149796732d18">chSerialNumber</a>);</div><div class="line">                <span class="keywordflow">break</span>;</div><div class="line">            }</div><div class="line">        <span class="keywordflow">case</span> <a class="code" href="group___xE5_xAE_x8F_xE5_xAE_x9A_xE4_xB9_x89.html#gab660cf959a9999fbb80d14a6db6e774e">MV_FG_CAMERALINK_INTERFACE</a>:</div><div class="line">            {</div><div class="line">                printf(<span class="stringliteral">&quot;[CML]No.%d Interface: \n\tDisplayName: %s\n\tInterfaceID: %s\n\tSerialNumber:%s\n&quot;</span>, i, </div><div class="line">                    stInterfaceInfo.<a class="code" href="struct_m_v___f_g___i_n_t_e_r_f_a_c_e___i_n_f_o.html#afb77e70ec406cf3b67e6f1d5c0fd33de">IfaceInfo</a>.<a class="code" href="struct_m_v___f_g___i_n_t_e_r_f_a_c_e___i_n_f_o.html#a3938ba2611045ac128d2f406a6cdf84c">stCMLIfaceInfo</a>.<a class="code" href="struct_m_v___c_m_l___i_n_t_e_r_f_a_c_e___i_n_f_o.html#aa7711c64eb456bf7b54b3912ae2c2217">chDisplayName</a>, </div><div class="line">                    stInterfaceInfo.<a class="code" href="struct_m_v___f_g___i_n_t_e_r_f_a_c_e___i_n_f_o.html#afb77e70ec406cf3b67e6f1d5c0fd33de">IfaceInfo</a>.<a class="code" href="struct_m_v___f_g___i_n_t_e_r_f_a_c_e___i_n_f_o.html#a3938ba2611045ac128d2f406a6cdf84c">stCMLIfaceInfo</a>.<a class="code" href="struct_m_v___c_m_l___i_n_t_e_r_f_a_c_e___i_n_f_o.html#a5970c47b258315360bf252b26c7d9112">chInterfaceID</a>, </div><div class="line">                    stInterfaceInfo.<a class="code" href="struct_m_v___f_g___i_n_t_e_r_f_a_c_e___i_n_f_o.html#afb77e70ec406cf3b67e6f1d5c0fd33de">IfaceInfo</a>.<a class="code" href="struct_m_v___f_g___i_n_t_e_r_f_a_c_e___i_n_f_o.html#a3938ba2611045ac128d2f406a6cdf84c">stCMLIfaceInfo</a>.<a class="code" href="struct_m_v___c_m_l___i_n_t_e_r_f_a_c_e___i_n_f_o.html#ad313642c0cca5a1a5c80149796732d18">chSerialNumber</a>);</div><div class="line">                <span class="keywordflow">break</span>;</div><div class="line">            }</div><div class="line">        <span class="keywordflow">default</span>:</div><div class="line">            {</div><div class="line">                printf(<span class="stringliteral">&quot;Unknown interface type.\n&quot;</span>);</div><div class="line">                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line">            }</div><div class="line">        }</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line">}</div><div class="line"></div><div class="line"><span class="comment">// Print device information</span></div><div class="line"><span class="keywordtype">bool</span> PrintDeviceInfo(<a class="code" href="group___xE5_xAE_x8F_xE5_xAE_x9A_xE4_xB9_x89.html#ga365c8ff08ed6aa7fb24dfe0d28109f29">IFHANDLE</a> hInterface, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nDeviceNum)</div><div class="line">{</div><div class="line">    <span class="keywordtype">int</span> nRet = 0;</div><div class="line"></div><div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; nDeviceNum; i++)</div><div class="line">    {</div><div class="line">        <a class="code" href="struct_m_v___f_g___d_e_v_i_c_e___i_n_f_o.html">MV_FG_DEVICE_INFO</a> stDeviceInfo = { 0 };</div><div class="line"></div><div class="line">        nRet = <a class="code" href="group___xE7_x9B_xB8_xE6_x9C_xBA_xE6_x8E_xA5_xE5_x8F_xA3.html#gaf772d9419afc70679d04c89370d5bed0">MV_FG_GetDeviceInfo</a>(hInterface, i, &amp;stDeviceInfo);</div><div class="line">        <span class="keywordflow">if</span> (MV_FG_SUCCESS != nRet)</div><div class="line">        {</div><div class="line">            printf(<span class="stringliteral">&quot;Get info of No.%d device failed! %#x\n&quot;</span>, i, nRet);</div><div class="line">            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line">        }</div><div class="line"></div><div class="line">        <span class="keywordflow">switch</span> (stDeviceInfo.<a class="code" href="struct_m_v___f_g___d_e_v_i_c_e___i_n_f_o.html#afa780142302fa781aa36ba1b966e1c9d">nDevType</a>)</div><div class="line">        {</div><div class="line">        <span class="keywordflow">case</span> <a class="code" href="group___xE5_xAE_x8F_xE5_xAE_x9A_xE4_xB9_x89.html#ga117f48f21587aad313469bff5a234f22">MV_FG_CXP_DEVICE</a>:</div><div class="line">            {</div><div class="line">                printf(<span class="stringliteral">&quot;[CXP]No.%d Device: \n\tUserDefinedName: %s\n\tModelName: %s\n\tSerialNumber: %s\n&quot;</span>, i, </div><div class="line">                    stDeviceInfo.<a class="code" href="struct_m_v___f_g___d_e_v_i_c_e___i_n_f_o.html#a47d4f0038d4da876d63e283d08206334">DevInfo</a>.<a class="code" href="struct_m_v___f_g___d_e_v_i_c_e___i_n_f_o.html#a5c59a961e3880bf66c6da69e7cd43ab5">stCXPDevInfo</a>.<a class="code" href="struct_m_v___c_x_p___d_e_v_i_c_e___i_n_f_o.html#ae5645a9eb2d3a4f6e0addd4a9c205c9f">chUserDefinedName</a>,</div><div class="line">                    stDeviceInfo.<a class="code" href="struct_m_v___f_g___d_e_v_i_c_e___i_n_f_o.html#a47d4f0038d4da876d63e283d08206334">DevInfo</a>.<a class="code" href="struct_m_v___f_g___d_e_v_i_c_e___i_n_f_o.html#a5c59a961e3880bf66c6da69e7cd43ab5">stCXPDevInfo</a>.<a class="code" href="struct_m_v___c_x_p___d_e_v_i_c_e___i_n_f_o.html#a2fefa227de1eca05613a815334b52027">chModelName</a>,</div><div class="line">                    stDeviceInfo.<a class="code" href="struct_m_v___f_g___d_e_v_i_c_e___i_n_f_o.html#a47d4f0038d4da876d63e283d08206334">DevInfo</a>.<a class="code" href="struct_m_v___f_g___d_e_v_i_c_e___i_n_f_o.html#a5c59a961e3880bf66c6da69e7cd43ab5">stCXPDevInfo</a>.<a class="code" href="struct_m_v___c_x_p___d_e_v_i_c_e___i_n_f_o.html#a70061da690bda55618f240cd3f68f012">chSerialNumber</a>);</div><div class="line">                <span class="keywordflow">break</span>;</div><div class="line">            }</div><div class="line">        <span class="keywordflow">case</span> <a class="code" href="group___xE5_xAE_x8F_xE5_xAE_x9A_xE4_xB9_x89.html#gab46fc24506b43c3f241dfa2c44017fb2">MV_FG_GEV_DEVICE</a>:</div><div class="line">            {</div><div class="line">                printf(<span class="stringliteral">&quot;[GEV]No.%d Device: \n\tUserDefinedName: %s\n\tModelName: %s\n\tSerialNumber: %s\n&quot;</span>, i, </div><div class="line">                    stDeviceInfo.<a class="code" href="struct_m_v___f_g___d_e_v_i_c_e___i_n_f_o.html#a47d4f0038d4da876d63e283d08206334">DevInfo</a>.<a class="code" href="struct_m_v___f_g___d_e_v_i_c_e___i_n_f_o.html#a24431f8406b305f22055c6a6d216967f">stGEVDevInfo</a>.<a class="code" href="struct_m_v___g_e_v___d_e_v_i_c_e___i_n_f_o.html#ae5645a9eb2d3a4f6e0addd4a9c205c9f">chUserDefinedName</a>,</div><div class="line">                    stDeviceInfo.<a class="code" href="struct_m_v___f_g___d_e_v_i_c_e___i_n_f_o.html#a47d4f0038d4da876d63e283d08206334">DevInfo</a>.<a class="code" href="struct_m_v___f_g___d_e_v_i_c_e___i_n_f_o.html#a24431f8406b305f22055c6a6d216967f">stGEVDevInfo</a>.<a class="code" href="struct_m_v___g_e_v___d_e_v_i_c_e___i_n_f_o.html#a2fefa227de1eca05613a815334b52027">chModelName</a>,</div><div class="line">                    stDeviceInfo.<a class="code" href="struct_m_v___f_g___d_e_v_i_c_e___i_n_f_o.html#a47d4f0038d4da876d63e283d08206334">DevInfo</a>.<a class="code" href="struct_m_v___f_g___d_e_v_i_c_e___i_n_f_o.html#a24431f8406b305f22055c6a6d216967f">stGEVDevInfo</a>.<a class="code" href="struct_m_v___g_e_v___d_e_v_i_c_e___i_n_f_o.html#a70061da690bda55618f240cd3f68f012">chSerialNumber</a>);</div><div class="line">                <span class="keywordflow">break</span>;</div><div class="line">            }</div><div class="line">        <span class="keywordflow">case</span> <a class="code" href="group___xE5_xAE_x8F_xE5_xAE_x9A_xE4_xB9_x89.html#ga0c755dcef89ceb76283b1385c05675c9">MV_FG_CAMERALINK_DEVICE</a>:</div><div class="line">            {</div><div class="line">                printf(<span class="stringliteral">&quot;[CML]No.%d Device: \n\tUserDefinedName: %s\n\tModelName: %s\n\tSerialNumber: %s\n&quot;</span>, i, </div><div class="line">                    stDeviceInfo.<a class="code" href="struct_m_v___f_g___d_e_v_i_c_e___i_n_f_o.html#a47d4f0038d4da876d63e283d08206334">DevInfo</a>.<a class="code" href="struct_m_v___f_g___d_e_v_i_c_e___i_n_f_o.html#acf54fb1bf4750ec535ec695532f5a640">stCMLDevInfo</a>.<a class="code" href="struct_m_v___c_m_l___d_e_v_i_c_e___i_n_f_o.html#ae5645a9eb2d3a4f6e0addd4a9c205c9f">chUserDefinedName</a>,</div><div class="line">                    stDeviceInfo.<a class="code" href="struct_m_v___f_g___d_e_v_i_c_e___i_n_f_o.html#a47d4f0038d4da876d63e283d08206334">DevInfo</a>.<a class="code" href="struct_m_v___f_g___d_e_v_i_c_e___i_n_f_o.html#acf54fb1bf4750ec535ec695532f5a640">stCMLDevInfo</a>.<a class="code" href="struct_m_v___c_m_l___d_e_v_i_c_e___i_n_f_o.html#a2fefa227de1eca05613a815334b52027">chModelName</a>,</div><div class="line">                    stDeviceInfo.<a class="code" href="struct_m_v___f_g___d_e_v_i_c_e___i_n_f_o.html#a47d4f0038d4da876d63e283d08206334">DevInfo</a>.<a class="code" href="struct_m_v___f_g___d_e_v_i_c_e___i_n_f_o.html#acf54fb1bf4750ec535ec695532f5a640">stCMLDevInfo</a>.<a class="code" href="struct_m_v___c_m_l___d_e_v_i_c_e___i_n_f_o.html#a70061da690bda55618f240cd3f68f012">chSerialNumber</a>);</div><div class="line">                <span class="keywordflow">break</span>;</div><div class="line">            }</div><div class="line">        <span class="keywordflow">default</span>:</div><div class="line">            {</div><div class="line">                printf(<span class="stringliteral">&quot;Unknown device type.\n&quot;</span>);</div><div class="line">                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line">            }</div><div class="line">        }</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keywordtype">int</span> main()</div><div class="line">{</div><div class="line">    <span class="keywordtype">int</span>             nRet = 0;</div><div class="line">    <a class="code" href="group___xE5_xAE_x8F_xE5_xAE_x9A_xE4_xB9_x89.html#ga365c8ff08ed6aa7fb24dfe0d28109f29">IFHANDLE</a>        hInterface = NULL;</div><div class="line">    <a class="code" href="group___xE5_xAE_x8F_xE5_xAE_x9A_xE4_xB9_x89.html#ga0ecdcce3a277e32beb329eaaa2f7e0a5">DEVHANDLE</a>       hDevice = NULL;</div><div class="line">    <a class="code" href="group___xE5_xAE_x8F_xE5_xAE_x9A_xE4_xB9_x89.html#ga8fc71f0c8b24123c2313e89bb4d05afe">STREAMHANDLE</a>    hStream = NULL;</div><div class="line"></div><div class="line">    <span class="keywordflow">do</span></div><div class="line">    {</div><div class="line">        <span class="comment">// Enumerate frame grabbers</span></div><div class="line">        <span class="keywordtype">bool</span> bChanged = <span class="keyword">false</span>;</div><div class="line">        nRet = <a class="code" href="group___xE9_x87_x87_xE9_x9B_x86_xE5_x8D_xA1_xE6_x8E_xA5_xE5_x8F_xA3.html#ga4b276232c23a21b0e6e57ad5a5104f33">MV_FG_UpdateInterfaceList</a>(<a class="code" href="group___xE5_xAE_x8F_xE5_xAE_x9A_xE4_xB9_x89.html#gab9b05f0522e4b358ed02c8bff9b5a46c">MV_FG_CXP_INTERFACE</a> | <a class="code" href="group___xE5_xAE_x8F_xE5_xAE_x9A_xE4_xB9_x89.html#gadad33b1e17a74130be022c10652b7912">MV_FG_GEV_INTERFACE</a> | <a class="code" href="group___xE5_xAE_x8F_xE5_xAE_x9A_xE4_xB9_x89.html#gab660cf959a9999fbb80d14a6db6e774e">MV_FG_CAMERALINK_INTERFACE</a>, &amp;bChanged);</div><div class="line">        <span class="keywordflow">if</span> (MV_FG_SUCCESS != nRet)</div><div class="line">        {</div><div class="line">            printf(<span class="stringliteral">&quot;Update interface list failed! %#x\n&quot;</span>, nRet);</div><div class="line">            <span class="keywordflow">break</span>;</div><div class="line">        }</div><div class="line"></div><div class="line">        <span class="comment">// Get the number of frame grabbers</span></div><div class="line">        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nInterfaceNum = 0;</div><div class="line">        nRet = <a class="code" href="group___xE9_x87_x87_xE9_x9B_x86_xE5_x8D_xA1_xE6_x8E_xA5_xE5_x8F_xA3.html#gadc46becbe6035a2fb5283ad1fb6b698c">MV_FG_GetNumInterfaces</a>(&amp;nInterfaceNum);</div><div class="line">        <span class="keywordflow">if</span> (MV_FG_SUCCESS != nRet || 0 == nInterfaceNum)</div><div class="line">        {</div><div class="line">            printf(<span class="stringliteral">&quot;No interface found! return = %d, number = %d\n&quot;</span>, nRet, nInterfaceNum);</div><div class="line">            <span class="keywordflow">break</span>;</div><div class="line">        }</div><div class="line"></div><div class="line">        <span class="comment">// Show frame grabber information</span></div><div class="line">        <span class="keywordflow">if</span> (<span class="keyword">false</span> == PrintInterfaceInfo(nInterfaceNum))</div><div class="line">        {</div><div class="line">            <span class="keywordflow">break</span>;</div><div class="line">        }</div><div class="line"></div><div class="line">        <span class="comment">// Select frame grabber</span></div><div class="line">        <span class="keywordtype">int</span> nInterfaceIndex = -1;</div><div class="line">        printf(<span class="stringliteral">&quot;Select an interface: &quot;</span>);</div><div class="line">        scanf_s(<span class="stringliteral">&quot;%d&quot;</span>, &amp;nInterfaceIndex);</div><div class="line">        ClearStdin();</div><div class="line"></div><div class="line">        <span class="keywordflow">if</span> (nInterfaceIndex &lt; 0 || nInterfaceIndex &gt;= (<span class="keywordtype">int</span>)nInterfaceNum)</div><div class="line">        {</div><div class="line">            printf(<span class="stringliteral">&quot;Invalid interface index.\nQuit.\n&quot;</span>);</div><div class="line">            <span class="keywordflow">break</span>;</div><div class="line">        }</div><div class="line"></div><div class="line">        <span class="comment">// Open frame grabber with specified permission, and get handle</span></div><div class="line">        nRet = <a class="code" href="group___xE9_x87_x87_xE9_x9B_x86_xE5_x8D_xA1_xE6_x8E_xA5_xE5_x8F_xA3.html#ga92dda0377f4e7bca95a93fcc22390f31">MV_FG_OpenInterface</a>((<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)nInterfaceIndex, &amp;hInterface);</div><div class="line">        <span class="keywordflow">if</span> (MV_FG_SUCCESS != nRet)</div><div class="line">        {</div><div class="line">            printf(<span class="stringliteral">&quot;Open No.%d interface failed! %#x\n&quot;</span>, nInterfaceIndex, nRet);</div><div class="line">            <span class="keywordflow">break</span>;</div><div class="line">        }</div><div class="line"></div><div class="line">        <span class="comment">// Enumerate cameras on the frame grabber</span></div><div class="line">        nRet = <a class="code" href="group___xE7_x9B_xB8_xE6_x9C_xBA_xE6_x8E_xA5_xE5_x8F_xA3.html#ga6c88774e76403df9e0c35366be13796a">MV_FG_UpdateDeviceList</a>(hInterface, &amp;bChanged);</div><div class="line">        <span class="keywordflow">if</span> (MV_FG_SUCCESS != nRet)</div><div class="line">        {</div><div class="line">            printf(<span class="stringliteral">&quot;Update device list failed! %#x\n&quot;</span>, nRet);</div><div class="line">            <span class="keywordflow">break</span>;</div><div class="line">        }</div><div class="line"></div><div class="line">        <span class="comment">// Get the number of devices</span></div><div class="line">        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nDeviceNum = 0;</div><div class="line">        nRet = <a class="code" href="group___xE7_x9B_xB8_xE6_x9C_xBA_xE6_x8E_xA5_xE5_x8F_xA3.html#gacd122cda410e9ae7f6d38dd2f3a05f87">MV_FG_GetNumDevices</a>(hInterface, &amp;nDeviceNum);</div><div class="line">        <span class="keywordflow">if</span> (MV_FG_SUCCESS != nRet || 0 == nDeviceNum)</div><div class="line">        {</div><div class="line">            printf(<span class="stringliteral">&quot;No device found! return = %d, number = %d\n&quot;</span>, nRet, nDeviceNum);</div><div class="line">            <span class="keywordflow">break</span>;</div><div class="line">        }</div><div class="line"></div><div class="line">        <span class="comment">// Show device information</span></div><div class="line">        <span class="keywordflow">if</span> (<span class="keyword">false</span> == PrintDeviceInfo(hInterface, nDeviceNum))</div><div class="line">        {</div><div class="line">            <span class="keywordflow">break</span>;</div><div class="line">        }</div><div class="line"></div><div class="line">        <span class="comment">// Select device</span></div><div class="line">        <span class="keywordtype">int</span> nDeviceIndex = -1;</div><div class="line">        printf(<span class="stringliteral">&quot;Select a device: &quot;</span>);</div><div class="line">        scanf_s(<span class="stringliteral">&quot;%d&quot;</span>, &amp;nDeviceIndex);</div><div class="line">        ClearStdin();</div><div class="line"></div><div class="line">        <span class="keywordflow">if</span> (nDeviceIndex &lt; 0 || nDeviceIndex &gt;= (<span class="keywordtype">int</span>)nDeviceNum)</div><div class="line">        {</div><div class="line">            printf(<span class="stringliteral">&quot;Invalid device index.\nQuit.\n&quot;</span>);</div><div class="line">            <span class="keywordflow">break</span>;</div><div class="line">        }</div><div class="line"></div><div class="line">        <span class="comment">// Open device, and get handle</span></div><div class="line">        nRet = <a class="code" href="group___xE7_x9B_xB8_xE6_x9C_xBA_xE6_x8E_xA5_xE5_x8F_xA3.html#gaac9bf0fd2e16730ea478af2f76f11df3">MV_FG_OpenDevice</a>(hInterface, (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)nDeviceIndex, &amp;hDevice);</div><div class="line">        <span class="keywordflow">if</span> (MV_FG_SUCCESS != nRet)</div><div class="line">        {</div><div class="line">            printf(<span class="stringliteral">&quot;Open No.%d device failed! %#x\n&quot;</span>, nDeviceIndex, nRet);</div><div class="line">            hDevice = NULL;</div><div class="line">            <span class="keywordflow">break</span>;</div><div class="line">        }</div><div class="line"></div><div class="line">        <span class="comment">// Close trigger mode</span></div><div class="line">        nRet = <a class="code" href="group___xE5_xB1_x9E_xE6_x80_xA7_xE9_x85_x8D_xE7_xBD_xAE_xE6_x8E_xA5_xE5_x8F_xA3.html#ga5d3608599b1901c97ddd376d3eef3413">MV_FG_SetEnumValueByString</a>(hDevice, <span class="stringliteral">&quot;TriggerMode&quot;</span>, <span class="stringliteral">&quot;Off&quot;</span>);</div><div class="line">        <span class="keywordflow">if</span> (MV_FG_SUCCESS != nRet)</div><div class="line">        {</div><div class="line">            printf(<span class="stringliteral">&quot;Turn off trigger mode failed! %#x\n&quot;</span>, nRet);</div><div class="line">            <span class="keywordflow">break</span>;</div><div class="line">        }</div><div class="line"></div><div class="line">        <span class="comment">// Get the number of stream channels</span></div><div class="line">        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nStreamNum = 0;</div><div class="line">        nRet = <a class="code" href="group___xE5_x9B_xBE_xE5_x83_x8F_xE9_x87_x87_xE9_x9B_x86_xE6_x8E_xA5_xE5_x8F_xA3.html#gab17defc955fd688f9446bd0045428870">MV_FG_GetNumStreams</a>(hDevice, &amp;nStreamNum);</div><div class="line">        <span class="keywordflow">if</span> (MV_FG_SUCCESS != nRet || 0 == nStreamNum)</div><div class="line">        {</div><div class="line">            printf(<span class="stringliteral">&quot;No stream available! return = %d, number = %d\n&quot;</span>, nRet, nStreamNum);</div><div class="line">            <span class="keywordflow">break</span>;</div><div class="line">        }</div><div class="line"></div><div class="line">        <span class="comment">// Open stream channel (stream 0 by default)</span></div><div class="line">        nRet = <a class="code" href="group___xE5_x9B_xBE_xE5_x83_x8F_xE9_x87_x87_xE9_x9B_x86_xE6_x8E_xA5_xE5_x8F_xA3.html#ga5baadf4aae39d682049189eeb3dba3c9">MV_FG_OpenStream</a>(hDevice, 0, &amp;hStream);</div><div class="line">        <span class="keywordflow">if</span> (MV_FG_SUCCESS != nRet)</div><div class="line">        {</div><div class="line">            printf(<span class="stringliteral">&quot;Open stream failed! %#x\n&quot;</span>, nRet);</div><div class="line">            <span class="keywordflow">break</span>;</div><div class="line">        }</div><div class="line"></div><div class="line">        <span class="comment">// Set the number of internal buffers</span></div><div class="line">        nRet = <a class="code" href="group___xE5_x9B_xBE_xE5_x83_x8F_xE9_x87_x87_xE9_x9B_x86_xE6_x8E_xA5_xE5_x8F_xA3.html#gabf595b8cea350b96d8c156a26c0c7ed6">MV_FG_SetBufferNum</a>(hStream, BUFFER_NUMBER);</div><div class="line">        <span class="keywordflow">if</span> (MV_FG_SUCCESS != nRet)</div><div class="line">        {</div><div class="line">            printf(<span class="stringliteral">&quot;Set buffer number failed! %#x\n&quot;</span>, nRet);</div><div class="line">            <span class="keywordflow">break</span>;</div><div class="line">        }</div><div class="line"></div><div class="line">        <span class="comment">// Register frame info callback</span></div><div class="line">        nRet = <a class="code" href="group___xE5_x9B_xBE_xE5_x83_x8F_xE9_x87_x87_xE9_x9B_x86_xE6_x8E_xA5_xE5_x8F_xA3.html#gabe7b5df83580c256b5f6fc53c7875246">MV_FG_RegisterFrameCallBack</a>(hStream, FrameCb, NULL);</div><div class="line">        <span class="keywordflow">if</span> (MV_FG_SUCCESS != nRet)</div><div class="line">        {</div><div class="line">            printf(<span class="stringliteral">&quot;Register frame callback failed! %#x\n&quot;</span>, nRet);</div><div class="line">            <span class="keywordflow">break</span>;</div><div class="line">        }</div><div class="line"></div><div class="line">        <span class="comment">// Start acquisition</span></div><div class="line">        nRet = <a class="code" href="group___xE5_x9B_xBE_xE5_x83_x8F_xE9_x87_x87_xE9_x9B_x86_xE6_x8E_xA5_xE5_x8F_xA3.html#gac1772dd2bc2a1ddf9fbc28044cd6742a">MV_FG_StartAcquisition</a>(hStream);</div><div class="line">        <span class="keywordflow">if</span> (MV_FG_SUCCESS != nRet)</div><div class="line">        {</div><div class="line">            printf(<span class="stringliteral">&quot;Start acquistion failed! %#x\n&quot;</span>, nRet);</div><div class="line">            <span class="keywordflow">break</span>;</div><div class="line">        }</div><div class="line"></div><div class="line">        printf(<span class="stringliteral">&quot;Press any key to stop acquisition.\n&quot;</span>);</div><div class="line">        WaitForKeyPress();</div><div class="line"></div><div class="line">        <span class="comment">// Stop acquisition</span></div><div class="line">        nRet = <a class="code" href="group___xE5_x9B_xBE_xE5_x83_x8F_xE9_x87_x87_xE9_x9B_x86_xE6_x8E_xA5_xE5_x8F_xA3.html#ga230e6896d6400514748b593b9d3c704b">MV_FG_StopAcquisition</a>(hStream);</div><div class="line">        <span class="keywordflow">if</span> (MV_FG_SUCCESS != nRet)</div><div class="line">        {</div><div class="line">            printf(<span class="stringliteral">&quot;Stop acquisition failed! %#x\n&quot;</span>, nRet);</div><div class="line">            <span class="keywordflow">break</span>;</div><div class="line">        }</div><div class="line">    } <span class="keywordflow">while</span> (0);</div><div class="line"></div><div class="line">    <span class="comment">// Close stream channel</span></div><div class="line">    <span class="keywordflow">if</span> (NULL != hStream)</div><div class="line">    {</div><div class="line">        nRet = <a class="code" href="group___xE5_x9B_xBE_xE5_x83_x8F_xE9_x87_x87_xE9_x9B_x86_xE6_x8E_xA5_xE5_x8F_xA3.html#ga7d5479a027ca49239ca1e9253e986008">MV_FG_CloseStream</a>(hStream);</div><div class="line">        <span class="keywordflow">if</span> (MV_FG_SUCCESS != nRet)</div><div class="line">        {</div><div class="line">            printf(<span class="stringliteral">&quot;Close stream failed! %#x\n&quot;</span>, nRet);</div><div class="line">        }</div><div class="line">        hStream = NULL;</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="comment">// Close device</span></div><div class="line">    <span class="keywordflow">if</span> (NULL != hDevice)</div><div class="line">    {</div><div class="line">        nRet = <a class="code" href="group___xE7_x9B_xB8_xE6_x9C_xBA_xE6_x8E_xA5_xE5_x8F_xA3.html#ga6d12de1a1f2c37e22fcf8aec4af48e41">MV_FG_CloseDevice</a>(hDevice);</div><div class="line">        <span class="keywordflow">if</span> (MV_FG_SUCCESS != nRet)</div><div class="line">        {</div><div class="line">            printf(<span class="stringliteral">&quot;Close device failed! %#x\n&quot;</span>, nRet);</div><div class="line">        }</div><div class="line">        hDevice = NULL;</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="comment">// Close frame grabber</span></div><div class="line">    <span class="keywordflow">if</span> (NULL != hInterface)</div><div class="line">    {</div><div class="line">        nRet = <a class="code" href="group___xE9_x87_x87_xE9_x9B_x86_xE5_x8D_xA1_xE6_x8E_xA5_xE5_x8F_xA3.html#ga34133899f81836e2bef39d91b2e242a4">MV_FG_CloseInterface</a>(hInterface);</div><div class="line">        <span class="keywordflow">if</span> (MV_FG_SUCCESS != nRet)</div><div class="line">        {</div><div class="line">            printf(<span class="stringliteral">&quot;Close interface failed! %#x\n&quot;</span>, nRet);</div><div class="line">        }</div><div class="line">        hInterface = NULL;</div><div class="line">    }</div><div class="line"></div><div class="line">    printf(<span class="stringliteral">&quot;Press any key to exit.\n&quot;</span>);</div><div class="line">    WaitForKeyPress();</div><div class="line"></div><div class="line">    <span class="keywordflow">return</span> 0;</div><div class="line">}</div></div><!-- fragment --> </div> </div></div><!-- PageDoc -->
</div><!-- contents -->
<!-- start footer part -->
<div class="footer" style="text-align: right;">
	<hr/>
	<small></small>
</div>
</body>
</html>